<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>AI Interview Feedback Report</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
body { 
    font-family: 'Poppins', sans-serif; 
    background: radial-gradient(circle at top left, rgb(12,15,36), rgb(45,60,115) 70%);
    margin: 0; 
    padding: 40px; 
    color: rgb(230,240,255);
}
.container { 
    max-width: 900px; 
    margin: auto; 
    background: rgb(22,27,60); 
    border-radius: 15px; 
    box-shadow: 0 10px 30px rgba(0,0,0,0.6); 
    padding: 40px 50px; 
}
h1 { 
    text-align: center; 
    color: rgb(0,195,255); 
    font-size: 2rem; 
    margin-bottom: 10px; 
}
h3 { 
    color: rgb(125,95,255); 
    border-bottom: 2px solid rgba(0,195,255,0.3); 
    padding-bottom: 5px; 
    margin-top: 25px; 
}
.section { 
    background: rgb(32,37,70); 
    padding: 20px; 
    border-left: 5px solid rgb(0,195,255); 
    border-radius: 10px; 
    margin-top: 15px; 
    white-space: pre-wrap; 
    line-height: 1.6; 
}
.emotion-item { 
    margin-bottom: 10px; 
    padding: 10px; 
    background: rgb(25,30,60); 
    border-radius: 8px; 
}
.emotion-item strong { 
    color: rgb(0,195,255); 
}
canvas { 
    margin-top: 20px; 
    width: 100%; 
    height: 300px; 
    background: rgb(22,27,60); 
    border-radius: 10px; 
}

/* Dashboard Button */
.dashboard-btn {
    position: absolute;
    top: 30px;
    right: 50px;
    padding: 10px 20px;
    font-size: 0.95rem;
    font-weight: 600;
    border: none;
    border-radius: 8px;
    background: linear-gradient(135deg, rgb(0,195,255), rgb(125,95,255));
    color: #fff;
    cursor: pointer;
    box-shadow: 0 5px 15px rgba(0,195,255,0.4);
    transition: transform 0.2s, box-shadow 0.2s;
}
.dashboard-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(0,195,255,0.6);
}
</style>
</head>
<body>
  <div class="container">
    <h1>üìä AI Interview Feedback Report</h1>

    <h3>üéß Emotion Analysis</h3>
    <div id="emotion-container" class="section">Loading emotion data...</div>

    <canvas id="emotionChart"></canvas>

    <h3>üìù Final AI Feedback</h3>
    <div id="final-feedback" class="section">Loading final feedback...</div>
  </div>
 <button class="dashboard-btn" onclick="window.location.href='/dashboard'">Go to Dashboard</button>
  <script>
    async function loadResults() {
      // Fetch feedback and answers summary
      const res = await fetch("/final_feedback");
      const data = await res.json();

      // Display final feedback
      document.getElementById("final-feedback").innerText = data.final_feedback || "No feedback available.";

      const container = document.getElementById("emotion-container");

      if (!data.answers_summary || data.answers_summary.length === 0) {
        container.innerText = "No emotion data available.";
        return;
      }

      // Render emotion cards
      container.innerHTML = data.answers_summary
        .map(a => `<div class="emotion-item"><strong>Question ${a.question}:</strong> ${a.description}</div>`)
        .join("");

      // Render bar chart
      const ctx = document.getElementById("emotionChart");
      const emotionCounts = {};
      data.answers_summary.forEach(a => {
        emotionCounts[a.emotion] = (emotionCounts[a.emotion] || 0) + 1;
      });

      new Chart(ctx, {
        type: 'bar',
        data: {
          labels: Object.keys(emotionCounts),
          datasets: [{
            label: 'Emotion Frequency',
            data: Object.values(emotionCounts),
            backgroundColor: ['#4CAF50', '#FF9800', '#2196F3', '#F44336', '#9C27B0', '#9E9E9E'],
            borderRadius: 8
          }]
        },
        options: {
          responsive: true,
          plugins: {
            legend: { display: false },
            title: {
              display: true,
              text: 'Emotional Trends Across Interview',
              color: '#0d3b66',
              font: { size: 18, weight: 'bold' }
            }
          },
          scales: { y: { beginAtZero: true }, x: {} }
        }
      });
    }

    loadResults();
  </script>
</body>
</html>
